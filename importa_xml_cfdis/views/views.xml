<odoo>
  <data>

  <record  model="ir.ui.view" id="purchase_importa_cfdi_form">
      <field name="name">purchase.importa.cfdi.form</field>
      <field name="model">purchase.order</field>
      <field name="inherit_id" ref="purchase.purchase_order_form"/>        
      <field name="arch" type="xml">
          <field name="company_id" position="after">
            <field name="import_xml_cfdi"/>
          </field>
      </field>
  </record>

  <record  model="ir.ui.view" id="pmg_importa_cfdi_tree">
      <field name="name">pmg.importa.cfdi.tree</field>
      <field name="model">pmg.importa.cfdi</field>            
      <field name="arch" type="xml">
          <tree string="Importacion de Cfdis">
            <field name="name"/>
            <field name="file_name"/>
          </tree>
      </field>
  </record>

  <record  model="ir.ui.view" id="pmg_load_images_import_form">
    <field name="name">pmg.importa.cfdi.form</field>
    <field name="model">pmg.importa.cfdi</field>            
    <field name="arch" type="xml">          
        <form string="Importacion de Cfdis">
            <header>                        
                <button name="leer_archivo" type="object" string="Leer Archivo" 
                    class="oe_highlight" states='draft'/>
                  
                <field name="state" widget="statusbar" />
            </header>
            <sheet>
                <group>
                    <group>                         
                        <field name="name" readonly="1"/>     
                        <field name="file_xml" filename="file_name" states="draft"/>     
                        <field name="file_name" invisible="1"/>     
                    </group>
                </group>
                <notebook>
                  <page string="Lineas">                      
                    <field name="lines">
                      <tree string="Lineas">
                        <field name="cfdi_emisor_rfc"/>
                        <field name="cfdi_uuid"/>
                        <field name="cfdi_fecha"/>
                        <field name="cfdi_subtotal"/>
                        <field name="cfdi_total"/>
                        <field name="cfdi_state"/>
                      </tree>
                      <form>
                        <header>
                          <field name="cfdi_state" widget="statusbar"/>
                        </header>
                        <sheet>
                          <group>
                            <group>
                              <field name="cfdi_emisor_rfc"/>
                              <field name="cfdi_uuid"/>
                              <field name="cfdi_serie"/>
                              <field name="cfdi_folio"/>
                            </group>
                            <group>
                              <field name="cfdi_fecha"/>
                              <field name="cfdi_moneda"/>
                              <field name="cfdi_subtotal"/>
                              <field name="cfdi_total"/>
                              <field name="purchase_id"/>
                            </group>
                          </group>
                          <notebook>
                            <page string="Conceptos">
                              <field name="cfdi_product_ids">
                                <tree>
                                  <field name="cfdi_product_id"/>
                                  <field name="cfdi_product_sku"/>
                                  <field name="cfdi_product_description"/>
                                  <field name="cfdi_product_qty"/>
                                  <field name="cfdi_product_price"/>
                                  <field name="cfdi_product_discount"/>
                                  <field name="cfdi_product_tax_code"/>
                                  <field name="cfdi_product_tax_amount"/>
                                  <field name="cfdi_product_amount"/>
                                  <field name="cfdi_product_parte_sku"/>
                                </tree>
                              </field>
                            </page>
                            <page string="Otros">
                              <group>
                                <field name="cfdi_errors"/>
                                <field name="cfdi_data" groups="base.group_no_one"/>
                              </group>
                            </page>
                          </notebook>
                        </sheet>
                      </form>
                    </field>
                  </page>
                  <page string="Detalle">                      
                    <field name="lines_detail">
                      <tree string="Detalle" editable="bottom">
                        <field name="cfdi_product_id"/>
                        <field name="cfdi_product_sku"/>
                        <field name="cfdi_product_description"/>
                        <field name="cfdi_product_qty"/>
                        <field name="cfdi_product_price"/>
                        <field name="cfdi_product_discount"/>
                        <field name="cfdi_product_amount"/>
                        <field name="cfdi_product_parte_sku"/>
                        <field name="line_id"/>
                      </tree>                        
                    </field>
                  </page>
                </notebook>
            </sheet>
        </form>
    </field>
  </record>       

  <record model="ir.actions.act_window" id="pmg_importa_cfdi_action_window">
      <field name="name">Carga de Cfdis</field>
      <field name="res_model">pmg.importa.cfdi</field>
      <field name="view_mode">tree,form</field>
      <!-- <field name="view_type">form</field> -->
      <field name="domain"></field>
      <!-- <field name="view_id" ref="pmg_load_images_import_tree"/> -->
    </record>

    <menuitem id="menu_pmg_importa_cfdi"
      name="Carga de Cfdis"
      action="pmg_importa_cfdi_action_window"
      parent="purchase.menu_procurement_management"
      sequence="10"/>
   
  </data>
</odoo>